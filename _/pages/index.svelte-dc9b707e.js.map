{"version":3,"file":"index.svelte-dc9b707e.js","sources":["../../../../../src/lib/translate/Languages.svelte","../../../../../src/routes/index.svelte"],"sourcesContent":["<script lang=\"ts\">\r\n\timport { createEventDispatcher } from \"svelte\";\r\n\tconst dispach = createEventDispatcher();\r\n\r\n\texport let languagePromise: Promise<{ name: string; code: string }[]>;\r\n\texport let selectedLang: string;\r\n</script>\r\n\r\n<ul class=\"langs\">\r\n\t{#await languagePromise}\r\n\t\t<p>Loading languages... <span class=\"bi-arrow-repeat spin\" /></p>\r\n\t{:then languages}\r\n\t\t{#each languages as language}\r\n\t\t\t<li>\r\n\t\t\t\t<button\r\n\t\t\t\t\tclass:active={selectedLang === language.code}\r\n\t\t\t\t\tstyle={`--color: rgb(${Math.random() * 128 + 128}, ${\r\n\t\t\t\t\t\tMath.random() * 128 + 128\r\n\t\t\t\t\t}, ${Math.random() * 128 + 128})`}\r\n\t\t\t\t\ton:click={() => {\r\n\t\t\t\t\t\tselectedLang = language.code;\r\n\t\t\t\t\t\tdispach(\"change\");\r\n\t\t\t\t\t}}\r\n\t\t\t\t>\r\n\t\t\t\t\t{language.name}\r\n\t\t\t\t</button>\r\n\t\t\t</li>\r\n\t\t{/each}\r\n\t{/await}\r\n</ul>\r\n\r\n<style lang=\"scss\">\r\n\t.langs {\r\n\t\tlist-style: none;\r\n\t\tdisplay: flex;\r\n\t\tgap: 3px;\r\n\t\tflex-flow: row wrap;\r\n\t\tpadding: 0;\r\n\r\n\t\tli {\r\n\t\t\tbutton {\r\n\t\t\t\tpadding: 0.4em 0.8em;\r\n\t\t\t\tborder: 2px solid var(--col-c) {\r\n\t\t\t\t\tradius: 99vmax;\r\n\t\t\t\t}\r\n\t\t\t\tbackground-color: var(--col-2);\r\n\t\t\t\t@media (hover) {\r\n\t\t\t\t\t&:hover {\r\n\t\t\t\t\t\tbackground-color: var(--col-4);\r\n\t\t\t\t\t\tborder-color: var(--col-f);\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\t&:active {\r\n\t\t\t\t\tbackground-color: var(--col-b);\r\n\t\t\t\t\tcolor: var(--col-0);\r\n\t\t\t\t\tborder-color: var(--col-f);\r\n\t\t\t\t}\r\n\t\t\t\t&.active {\r\n\t\t\t\t\tbackground-color: var(--col-f);\r\n\t\t\t\t\tcolor: var(--col-0);\r\n\t\t\t\t\tborder-color: var(--col-f);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\t.spin::before {\r\n\t\tanimation: spin 1s linear infinite;\r\n\r\n\t\t@keyframes spin {\r\n\t\t\tto {\r\n\t\t\t\ttransform: rotate(360deg);\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n</style>\r\n","<!---->\n<script lang=\"ts\">\n\timport { onMount } from \"svelte\";\n\n\timport Languages from \"$lib/translate/Languages.svelte\";\n\n\tconst translateURL: string = \"https://translate.argosopentech.com\";\n\t// https://translate.astian.org/translate\n\t// https://translate.argosopentech.com\n\n\tlet focusedTextarea: number = -1;\n\n\tlet langs = [\n\t\t{\n\t\t\tlang: \"de\",\n\t\t\tlangName: \"German\",\n\t\t\tvalue: \"\",\n\t\t\ttextarea: undefined as HTMLTextAreaElement,\n\t\t},\n\t\t{\n\t\t\tlang: \"en\",\n\t\t\tlangName: \"English\",\n\t\t\tvalue: \"\",\n\t\t\ttextarea: undefined as HTMLTextAreaElement,\n\t\t},\n\t];\n\n\tlet requestsMade: number = 0;\n\tlet latestResponse: number = 0;\n\n\tconst languagePromise: Promise<\n\t\t{\n\t\t\tcode: string;\n\t\t\tname: string;\n\t\t}[]\n\t> = (async () =>\n\t\tawait (await window.fetch(`${translateURL}/languages`)).json())();\n\n\tlet languages: {\n\t\tcode: string;\n\t\tname: string;\n\t}[] = [];\n\n\tconst getTranslation = (isFirstTextarea: boolean) => async (evt?: Event) => {\n\t\tconst value: string = (\n\t\t\t(evt?.target as HTMLTextAreaElement) || langs[+!isFirstTextarea]\n\t\t).value.trim();\n\t\tif (!value)\n\t\t\treturn void window.setTimeout(() => (langs[+isFirstTextarea].value = \"\"));\n\t\tconst requestNr: number = requestsMade++;\n\t\tconst res: Response = await window.fetch(\n\t\t\t`${translateURL}/translate`, //\n\t\t\t{\n\t\t\t\tmethod: \"POST\",\n\t\t\t\tbody: JSON.stringify({\n\t\t\t\t\tq: value,\n\t\t\t\t\tsource: langs[+!isFirstTextarea].lang,\n\t\t\t\t\ttarget: langs[+isFirstTextarea].lang,\n\t\t\t\t\tformat: \"text\",\n\t\t\t\t}),\n\t\t\t\theaders: {\n\t\t\t\t\t\"Content-Type\": \"application/json\",\n\t\t\t\t},\n\t\t\t},\n\t\t);\n\t\tif (res.ok) {\n\t\t\tif (requestNr >= latestResponse) {\n\t\t\t\tlangs[+isFirstTextarea].value = (await res.json())?.translatedText;\n\t\t\t\tlatestResponse = requestNr;\n\t\t\t}\n\t\t} else {\n\t\t\tconsole.error(\n\t\t\t\t`Reqest failed with status ${res.status} (${res.statusText})`,\n\t\t\t);\n\t\t}\n\t};\n\n\tconst switchLangs = () => (evt?: Event) => {\n\t\tconst textarea = focusedTextarea;\n\t\tlangs = langs.reverse();\n\t\tgetTranslation(textarea !== 1)();\n\t\t(\n\t\t\tdocument\n\t\t\t\t.querySelector(\"section.translations\")\n\t\t\t\t.children[(focusedTextarea + 1 || 1) - 1]?.querySelector(\n\t\t\t\t\t\"textarea\",\n\t\t\t\t) as HTMLTextAreaElement\n\t\t)?.focus();\n\t\twindow.setTimeout(() => {\n\t\t\tfocusedTextarea = textarea;\n\t\t}, 250);\n\t};\n\n\tconst textareaFocus = (textarea: number, focus: boolean) => (evt?: Event) => {\n\t\tif (focus) {\n\t\t\tfocusedTextarea = textarea;\n\t\t} else {\n\t\t\twindow.setTimeout(() => {\n\t\t\t\tif (focusedTextarea === textarea) {\n\t\t\t\t\tfocusedTextarea = -1;\n\t\t\t\t}\n\t\t\t}, 250);\n\t\t}\n\t};\n\n\tonMount(async () => {\n\t\twindow.addEventListener(\"keypress\", (evt: KeyboardEvent) => {\n\t\t\tif (evt.code === \"KeyS\" && evt.ctrlKey && evt.shiftKey) {\n\t\t\t\tswitchLangs()();\n\t\t\t}\n\t\t\tif (!evt.ctrlKey && !evt.altKey && !evt.metaKey && focusedTextarea < 0) {\n\t\t\t\tlangs[0].textarea?.focus();\n\t\t\t}\n\t\t});\n\t\twindow.addEventListener(\"focus\", (evt: FocusEvent) => {\n\t\t\twindow.setTimeout(() => langs[0].textarea?.focus(), 100);\n\t\t});\n\t\tlangs[0].textarea?.focus();\n\t\tlanguages = await languagePromise;\n\t});\n</script>\n\n<svelte:head>\n\t<!---->\n</svelte:head>\n\n<div class=\"top-bar\">\n\t<button on:click={switchLangs()} class=\"bi-arrow-left-right switch-langs\" />\n</div>\n\n<section class=\"translations\">\n\t{#each [...Array(2)] as _, i (i)}\n\t\t<div class=\"translation from\">\n\t\t\t<textarea\n\t\t\t\ttabindex={1}\n\t\t\t\tplaceholder={i - +(focusedTextarea !== 1)\n\t\t\t\t\t? `Type ${langs[+(focusedTextarea === 1)].langName} here`\n\t\t\t\t\t: `See ${langs[+(focusedTextarea !== 1)].langName} translation here`}\n\t\t\t\ton:focus={textareaFocus(i, true)}\n\t\t\t\ton:blur={textareaFocus(i, false)}\n\t\t\t\ton:input={getTranslation(!i)}\n\t\t\t\tbind:value={langs[i].value}\n\t\t\t\tbind:this={langs[i].textarea}\n\t\t\t\tspellcheck={false}\n\t\t\t/>\n\t\t\t<Languages\n\t\t\t\t{languagePromise}\n\t\t\t\tbind:selectedLang={langs[i].lang}\n\t\t\t\ton:change={() => {\n\t\t\t\t\tgetTranslation(focusedTextarea !== 1)();\n\t\t\t\t\tlangs[i].langName = languages.filter(\n\t\t\t\t\t\t({ code }) => code === langs[i].lang,\n\t\t\t\t\t)[0].name;\n\t\t\t\t}}\n\t\t\t/>\n\t\t</div>\n\t{/each}\n</section>\n\n<!---->\n<style lang=\"scss\">\n\t@import \"../styles/functions-mixins\";\n\n\t.top-bar {\n\t\tdisplay: flex;\n\t\tflex-direction: row;\n\t\talign-items: center;\n\t\tjustify-content: center;\n\t\theight: 0;\n\n\t\tbutton.switch-langs {\n\t\t\tz-index: 1;\n\t\t\twidth: 2em;\n\t\t\theight: 2em;\n\t\t\taspect-ratio: 1;\n\t\t\tfont-size: 1.1em;\n\t\t\tbackground-color: var(--col-3);\n\t\t\ttransform: translateY(-0.25em);\n\t\t\tborder: none {\n\t\t\t\tradius: 99vmax;\n\t\t\t}\n\t\t\tbox-shadow: 0 0 0 0.3em var(--col-08);\n\n\t\t\t@media (hover) {\n\t\t\t\t&:hover {\n\t\t\t\t\tbackground-color: var(--col-5);\n\t\t\t\t}\n\t\t\t}\n\t\t\t&:active {\n\t\t\t\tbackground-color: var(--col-6);\n\t\t\t}\n\n\t\t\t&::before {\n\t\t\t\ttransform: translateY(0.08em);\n\t\t\t}\n\t\t}\n\t}\n\n\t.translations {\n\t\tdisplay: flex;\n\t\tflex-direction: row;\n\t\tjustify-content: space-around;\n\t\tgap: 1em;\n\t\t.translation {\n\t\t\tflex-grow: 1;\n\t\t\tflex-basis: 1;\n\t\t\ttextarea {\n\t\t\t\toutline: none;\n\t\t\t\theight: 5em;\n\t\t\t\tpadding: 0.6em;\n\t\t\t\tfont-size: 1.2em;\n\t\t\t\tfont-family: inherit;\n\t\t\t\tmin-height: 10em;\n\t\t\t\twidth: 100%;\n\t\t\t\tbackground-color: var(--col-3);\n\t\t\t\tborder: none {\n\t\t\t\t\tradius: 0.4em;\n\t\t\t\t}\n\t\t\t\tbox-shadow: 0 0 0.5em 0.2em var(--col-0);\n\t\t\t\tresize: vertical;\n\t\t\t\t// overflow: visible;\n\t\t\t\t// overflow-y: hidden;\n\t\t\t\t&:focus {\n\t\t\t\t\tbackground-color: var(--col-4);\n\t\t\t\t}\n\n\t\t\t\t&::placeholder {\n\t\t\t\t\tcolor: var(--col-a);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n</style>\n"],"names":["ctx","length","ctx2","name","Math","random","code","dispach","createEventDispatcher","languagePromise","selectedLang","language","lang","langName","value","Array","__awaiter","this","thisArg","_arguments","P","generator","focusedTextarea","langs","textarea","requestsMade","latestResponse","window","fetch","json","languages","getTranslation","evt","target","isFirstTextarea","trim","setTimeout","requestNr","res","method","body","JSON","stringify","q","source","format","headers","ok","_a","translatedText","error","status","statusText","switchLangs","reverse","document","querySelector","children","_b","focus","addEventListener","ctrlKey","shiftKey","altKey","metaKey","i","filter"],"mappings":"obAYSA,0BAALC,0NAAKC,aAALD,qIAAAA,iEAYED,KAASG,qQAR6B,IAAhBC,KAAKC,SAAiB,QAC5B,IAAhBD,KAAKC,SAAiB,QACF,IAAhBD,KAAKC,SAAiB,mDAHbL,OAAiBA,KAASM,+FASvCN,KAASG,mCATIH,OAAiBA,KAASM,qdANpCN,0QAAAA,wGAPFO,EAAUC,wBAELC,mBACAC,kIAeNA,EAAeC,EAASL,QAChB,mXC8HSN,KAAMA,OAAGY,sBAATZ,KAAMA,OAAGY,gZAblB,uBACGZ,QAA0B,kBAC5BA,OAA4B,WAAIa,uBACjCb,OAA4B,WAAIa,+CAM9B,uHAFAb,KAAMA,OAAGc,6DAHXd,KAAcA,OAAG,eAClBA,KAAcA,OAAG,gBAChBA,MAAgBA,2DALbA,QAA0B,kBAC5BA,OAA4B,WAAIa,uBACjCb,OAA4B,WAAIa,6DAI9Bb,KAAMA,OAAGc,6EAMFd,KAAMA,OAAGY,yLAhBpBG,MAAM,eAAab,sBAA5BD,8nBAJgBD,qCAIPe,MAAM,0EAAfd,qLAlIce,EAAAC,MAAAA,KAAAD,oBAAAE,EAAAC,EAAAC,EAAAC,yRASZC,KAEAC,IAEFX,KAAM,KACNC,SAAU,SACVC,MAAO,GACPU,cAAU,IAGVZ,KAAM,KACNC,SAAU,UACVC,MAAO,GACPU,cAAU,IAIRC,EAAuB,EACvBC,EAAyB,QAEvBjB,EAKUO,uDACFW,OAAOC,wDAAoCC,cAErDC,WAKEC,QAAqEf,gDACpEF,mBACJkB,EAAKC,SAAkCV,IAAQW,IAC/CpB,MAAMqB,WACHrB,cACQa,OAAOS,oBAAkBb,GAAOW,GAAiBpB,MAAQ,cAChEuB,EAAoBZ,IACpBa,QAAsBX,OAAOC,uDAGjCW,OAAQ,OACRC,KAAMC,KAAKC,WACVC,EAAG7B,EACH8B,OAAQrB,IAAQW,GAAiBtB,KACjCqB,OAAQV,GAAOW,GAAiBtB,KAChCiC,OAAQ,SAETC,SACC,eAAgB,sBAIfR,EAAIS,GACHV,GAAaX,QAChBH,GAAOW,GAAiBpB,MAA0B,gBAAXwB,EAAIT,kBAAOmB,SAAAA,EAAEC,oBACnCZ,WAGVa,mCACsBZ,EAAIa,WAAWb,EAAIc,kBAK7CC,wBACC7B,EAAWF,MACjBC,EAAQA,EAAM+B,aACc,IAAb9B,KAOd,UAH0C,UAF1C+B,SACEC,cAAc,wBACdC,YAA4B,GAAK,GAAK,cAAET,SAAAA,EAAEQ,cAC1C,uBAEFE,GAAAA,EAAEC,eACIvB,qBACNd,EAAkBE,KAChB,aAeeR,iDACX4C,iBAAiB,sBACN,SAAb5B,EAAI1B,MAAmB0B,EAAI6B,SAAW7B,EAAI8B,iBAGzC9B,EAAI6B,UAAY7B,EAAI+B,SAAW/B,EAAIgC,SAAW1C,EAAkB,IACnD,UAAjBC,EAAM,GAAGC,oBAAQwB,GAAAA,EAAEW,mBAGdC,iBAAiB,oBAChBxB,qBAAgBY,SAAkB,UAAjBzB,EAAM,GAAGC,oBAAQwB,SAAAA,EAAEW,UAAS,QAEpC,UAAjBpC,EAAM,GAAGC,oBAAQkC,GAAAA,EAAEC,YACnB7B,QAAkBrB,4BAzBIe,EAAkBmC,QACpCA,MACHrC,EAAkBE,UAEXY,iBACFd,IAAoBE,OACvBF,QAEC,oBAwCgB2C,GAAGnD,qEACJmD,GAAGzC,mDAKDD,EAAM0C,GAAGrD,YAAHqD,GAAGrD,sBAEQ,IAApBU,SACfC,EAAM0C,GAAGpD,SAAWiB,EAAUoC,UAC1B5D,KAAAA,KAAWA,IAASiB,EAAM0C,GAAGrD,OAC/B,GAAGT"}