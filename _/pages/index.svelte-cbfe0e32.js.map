{"version":3,"file":"index.svelte-cbfe0e32.js","sources":["../../../../../src/lib/translate/Languages.svelte","../../../../../src/routes/index.svelte"],"sourcesContent":["<script lang=\"ts\">\r\n\texport let languages: Promise<{ name: string; code: string }[]>;\r\n\texport let selectedLang: string;\r\n</script>\r\n\r\n<ul class=\"langs\">\r\n\t{#await languages}\r\n\t\t<p>Loading languages... <span class=\"bi-arrow-repeat spin\" /></p>\r\n\t{:then languages}\r\n\t\t{#each languages as language}\r\n\t\t\t<li>\r\n\t\t\t\t<button\r\n\t\t\t\t\tclass:active={selectedLang === language.code}\r\n\t\t\t\t\ton:click={() => (selectedLang = language.code)}\r\n\t\t\t\t>\r\n\t\t\t\t\t{language.name}\r\n\t\t\t\t</button>\r\n\t\t\t</li>\r\n\t\t{/each}\r\n\t{/await}\r\n</ul>\r\n\r\n<style lang=\"scss\">\r\n\t.langs {\r\n\t\tlist-style: none;\r\n\t\tdisplay: flex;\r\n\t\tgap: 3px;\r\n\t\tflex-flow: row wrap;\r\n\t\tpadding: 0;\r\n\r\n\t\tli {\r\n\t\t\tbutton {\r\n\t\t\t\tpadding: 0.4em 0.8em;\r\n\t\t\t\tborder: 2px solid var(--col-a) {\r\n\t\t\t\t\tradius: 99vmax;\r\n\t\t\t\t}\r\n\t\t\t\tbackground-color: var(--col-1);\r\n\t\t\t\t@media (hover) {\r\n\t\t\t\t\t&:hover {\r\n\t\t\t\t\t\tbackground-color: var(--col-4);\r\n\t\t\t\t\t\tborder-color: var(--col-f);\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\t&:active {\r\n\t\t\t\t\tbackground-color: var(--col-b);\r\n\t\t\t\t\tcolor: var(--col-0);\r\n\t\t\t\t\tborder-color: var(--col-f);\r\n\t\t\t\t}\r\n\t\t\t\t&.active {\r\n\t\t\t\t\tbackground-color: var(--col-f);\r\n\t\t\t\t\tcolor: var(--col-0);\r\n\t\t\t\t\tborder-color: var(--col-f);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\t.spin::before {\r\n\t\tanimation: spin 1s linear infinite;\r\n\r\n\t\t@keyframes spin {\r\n\t\t\tto {\r\n\t\t\t\ttransform: rotate(360deg);\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n</style>\r\n","<!---->\n<script lang=\"ts\">\n\timport { onMount } from \"svelte\";\n\n\timport Languages from \"$lib/translate/Languages.svelte\";\n\n\tconst translateURL: string = \"https://translate.argosopentech.com\";\n\t// https://translate.astian.org/translate\n\t// https://translate.argosopentech.com\n\n\tlet focusedTextarea: number = -1;\n\n\tlet langs = [\n\t\t{\n\t\t\tlang: \"de\",\n\t\t\tvalue: \"hallo\",\n\t\t},\n\t\t{\n\t\t\tlang: \"en\",\n\t\t\tvalue: \"hello\",\n\t\t},\n\t];\n\n\tlet requestsMade: number = 0;\n\tlet latestResponse: number = 0;\n\n\tlet languages: Promise<\n\t\t{\n\t\t\tcode: string;\n\t\t\tname: string;\n\t\t}[]\n\t> = (async () =>\n\t\tawait (await window.fetch(`${translateURL}/languages`)).json())();\n\n\tconst getTranslation = (isFirstTextarea: boolean) => async (evt: Event) => {\n\t\tconst value: string = (evt.target as HTMLTextAreaElement).value.trim();\n\t\tif (!value)\n\t\t\treturn void setTimeout(() => (langs[Number(isFirstTextarea)].value = \"\"));\n\t\tconst requestNr: number = requestsMade++;\n\t\tconst res: Response = await window.fetch(\n\t\t\t`${translateURL}/translate`, //\n\t\t\t{\n\t\t\t\tmethod: \"POST\",\n\t\t\t\tbody: JSON.stringify({\n\t\t\t\t\tq: value,\n\t\t\t\t\tsource: langs[Number(!isFirstTextarea)].lang,\n\t\t\t\t\ttarget: langs[Number(isFirstTextarea)].lang,\n\t\t\t\t\tformat: \"text\",\n\t\t\t\t}),\n\t\t\t\theaders: {\n\t\t\t\t\t\"Content-Type\": \"application/json\",\n\t\t\t\t},\n\t\t\t},\n\t\t);\n\t\tif (res.ok) {\n\t\t\tif (requestNr >= latestResponse) {\n\t\t\t\tlangs[Number(isFirstTextarea)].value = (\n\t\t\t\t\tawait res.json()\n\t\t\t\t)?.translatedText;\n\t\t\t\tlatestResponse = requestNr;\n\t\t\t}\n\t\t} else {\n\t\t\tconsole.error(\n\t\t\t\t`Reqest failed with status ${res.status} (${res.statusText})`,\n\t\t\t);\n\t\t}\n\t};\n\n\tconst switchLangs = () => (evt: Event) => {\n\t\tlangs = langs.reverse();\n\t\t(\n\t\t\tdocument\n\t\t\t\t.querySelector(\"section.translations\")\n\t\t\t\t.children[focusedTextarea]?.querySelector(\n\t\t\t\t\t\"textarea\",\n\t\t\t\t) as HTMLTextAreaElement\n\t\t)?.focus();\n\t};\n\n\tconst textareaFocus = (textarea: number, focus: boolean) => (evt: Event) => {\n\t\tif (focus) {\n\t\t\tfocusedTextarea = textarea;\n\t\t} else {\n\t\t\twindow.setTimeout(() => {\n\t\t\t\tif (focusedTextarea === textarea) {\n\t\t\t\t\tfocusedTextarea = -1;\n\t\t\t\t}\n\t\t\t}, 250);\n\t\t}\n\t\tconsole.log({ textarea, focus, focusedTextarea });\n\t};\n\n\tonMount(async () => {\n\t\tlanguages = await (await window.fetch(`${translateURL}/languages`)).json();\n\t});\n</script>\n\n<svelte:head>\n\t<!---->\n</svelte:head>\n\n<div class=\"top-bar\">\n\t<button on:click={switchLangs()} class=\"bi-arrow-left-right switch-langs\" />\n</div>\n\n<section class=\"translations\">\n\t<div class=\"translation from\">\n\t\t<textarea\n\t\t\ttabindex={1}\n\t\t\ton:focus={textareaFocus(0, true)}\n\t\t\ton:blur={textareaFocus(0, false)}\n\t\t\ton:input={getTranslation(true)}\n\t\t\tbind:value={langs[0].value}\n\t\t\tspellcheck={false}\n\t\t/>\n\t\t<Languages {languages} bind:selectedLang={langs[0].lang} />\n\t</div>\n\t<div class=\"translation to\">\n\t\t<textarea\n\t\t\ttabindex={1}\n\t\t\ton:focus={textareaFocus(1, true)}\n\t\t\ton:blur={textareaFocus(1, false)}\n\t\t\ton:input={getTranslation(false)}\n\t\t\tbind:value={langs[1].value}\n\t\t\tspellcheck={false}\n\t\t/>\n\t\t<Languages {languages} bind:selectedLang={langs[1].lang} />\n\t</div>\n</section>\n\n<!---->\n<style lang=\"scss\">\n\t@import \"../styles/functions-mixins\";\n\n\t.top-bar {\n\t\tdisplay: flex;\n\t\tflex-direction: row;\n\t\talign-items: center;\n\t\tjustify-content: center;\n\t\theight: 0;\n\n\t\tbutton.switch-langs {\n\t\t\tz-index: 1;\n\t\t\twidth: 2em;\n\t\t\theight: 2em;\n\t\t\taspect-ratio: 1;\n\t\t\tfont-size: 1.1em;\n\t\t\tbackground-color: var(--col-3);\n\t\t\ttransform: translateY(-0.25em);\n\t\t\tborder: none {\n\t\t\t\tradius: 99vmax;\n\t\t\t}\n\t\t\tbox-shadow: 0 0 0 0.3em var(--col-08);\n\n\t\t\t@media (hover) {\n\t\t\t\t&:hover {\n\t\t\t\t\tbackground-color: var(--col-5);\n\t\t\t\t}\n\t\t\t}\n\t\t\t&:active {\n\t\t\t\tbackground-color: var(--col-6);\n\t\t\t}\n\n\t\t\t&::before {\n\t\t\t\ttransform: translateY(0.08em);\n\t\t\t}\n\t\t}\n\t}\n\n\t.translations {\n\t\tdisplay: flex;\n\t\tflex-direction: row;\n\t\tjustify-content: space-around;\n\t\tgap: 1em;\n\t\t.translation {\n\t\t\tflex-grow: 1;\n\t\t\tflex-basis: 1;\n\t\t\ttextarea {\n\t\t\t\toutline: none;\n\t\t\t\theight: 5em;\n\t\t\t\tpadding: 0.6em;\n\t\t\t\tfont-size: 1.2em;\n\t\t\t\tfont-family: inherit;\n\t\t\t\tmin-height: 10em;\n\t\t\t\twidth: 100%;\n\t\t\t\tbackground-color: var(--col-3);\n\t\t\t\tborder: none {\n\t\t\t\t\tradius: 0.4em;\n\t\t\t\t}\n\t\t\t\tbox-shadow: 0 0 0.5em 0.2em var(--col-0);\n\t\t\t\tresize: vertical;\n\t\t\t\t// overflow: visible;\n\t\t\t\t// overflow-y: hidden;\n\t\t\t\t&:focus {\n\t\t\t\t\tbackground-color: var(--col-4);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n</style>\n"],"names":["ctx","length","ctx2","name","code","languages","selectedLang","language","lang","value","translateURL","__awaiter","this","thisArg","_arguments","P","generator","focusedTextarea","langs","requestsMade","latestResponse","window","fetch","json","evt","target","trim","setTimeout","Number","isFirstTextarea","requestNr","res","method","body","JSON","stringify","q","source","format","headers","ok","_a","translatedText","error","status","statusText","reverse","document","querySelector","children","_b","focus","textarea","log"],"mappings":"+YASSA,0BAALC,0NAAKC,aAALD,qIAAAA,+DAMED,KAASG,yQAHIH,OAAiBA,KAASI,+FAGvCJ,KAASG,mCAHIH,OAAiBA,KAASI,qdANpCJ,0QAAAA,gHALGK,mBACAC,mHAWUA,EAAeC,EAASH,kOCsGFJ,KAAM,GAAGQ,sBAATR,KAAM,GAAGQ,oGAWTR,KAAM,GAAGQ,sBAATR,KAAM,GAAGQ,uzBAlBxC,qBAKE,+FAMF,qBAKE,8LAZAR,KAAM,GAAGS,mDAWTT,KAAM,GAAGS,kDArBLT,oBAONA,KAAc,GAAG,eAClBA,KAAc,GAAG,gBAChBA,MAAe,kCASfA,KAAc,GAAG,eAClBA,KAAc,GAAG,gBAChBA,MAAe,gDAVbE,KAAM,GAAGO,wEAGoBP,KAAM,GAAGM,uCAQtCN,KAAM,GAAGO,wEAGoBP,KAAM,GAAGM,uMAxH9CE,EAAuB,4DALbC,EAAAC,MAAAA,KAAAD,oBAAAE,EAAAC,EAAAC,EAAAC,yRASZC,KAEAC,IAEFV,KAAM,KACNC,MAAO,UAGPD,KAAM,KACNC,MAAO,UAILU,EAAuB,EACvBC,EAAyB,EAEzBf,EAKYM,uDACFU,OAAOC,SAASZ,gBAA2Ba,wBA4DtCZ,wCAClBN,cAAyBgB,OAAOC,SAASZ,gBAA2Ba,wBA3DKZ,gDACnEF,EAAiBe,EAAIC,OAA+BhB,MAAMiB,WAC3DjB,cACQkB,oBAAkBT,EAAMU,OAAOC,IAAkBpB,MAAQ,cAChEqB,EAAoBX,IACpBY,QAAsBV,OAAOC,SAC/BZ,eAEFsB,OAAQ,OACRC,KAAMC,KAAKC,WACVC,EAAG3B,EACH4B,OAAQnB,EAAMU,QAAQC,IAAkBrB,KACxCiB,OAAQP,EAAMU,OAAOC,IAAkBrB,KACvC8B,OAAQ,SAETC,SACC,eAAgB,sBAIfR,EAAIS,GACHV,GAAaV,QAChBF,EAAMU,OAAOC,IAAkBpB,MAE9B,gBADMsB,EAAIR,kBACVkB,SAAAA,EAAEC,oBACcZ,WAGVa,mCACsBZ,EAAIa,WAAWb,EAAIc,sCAMlD3B,EAAQA,EAAM4B,WAOb,UAH2B,UAF3BC,SACEC,cAAc,wBACdC,SAAShC,cAAgBwB,SAAAA,EAAEO,cAC3B,uBAEFE,GAAAA,EAAEC,UAGmBC,EAAkBD,QACpCA,IACeC,SAEXzB,iBACFV,IAAoBmC,YAGtB,aAEIC,KAAMD,SAAAA,EAAUD,MAAAA,EAAOlC,gBAAAA,kBAuBZ,GAAGR,oDAGoBS,EAAM,GAAGV,YAAH,GAAGA,6BAQhC,GAAGC,oDAGoBS,EAAM,GAAGV,YAAH,GAAGA"}